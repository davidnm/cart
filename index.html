<!DOCTYPE html>
<html>
  <head>
    <title>Tomatoes Shopping Cart</title>
    <link href="./style.css" rel="stylesheet" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
  </head>
  <body>
    <header>
      <h1>Tomatoes Shopping Cart</h1>
    </header>
    <main>
      <section>
          <div>
            <table>
              <tr>
                  <td class="tdmain">Type</td>
                  <td class="tdmain">description</td>
                  <td class="tdmain">price</td>
                  <td class="tdmain"></td>

                </tr>
              <tr>
                <td>
                  <label for="hosting">raf tomato</label>
                  <img src="https://www.comenaranjas.com/images/stories/virtuemart/product/tomate-raf.jpg" class="responsive_image">              
                </td>
                <td>
                  It is a fruit of irregular shape with deep furrows that end in the center, oval and flattened at the ends. These grooves make it very recognizable and attest to its quality. Its color is deep green with touches approaching the black on top.
                </td>
                <td>
                    £6.99
                  </td>
                <td>
                  <input id="submitBtn1" type="submit" value="Add"/>
                </td>
              </tr>
              <tr>
                  <td>
                    <label for="hosting">heirloom tomato</label>
                    <img src="https://foodandstyle.com/wp-content/uploads/2009/07/IMG_9851-Hierloom-tomato-750.jpg" class="responsive_image">              
                  </td>
                  <td>
                      Many heirloom tomatoes are sweeter and lack a genetic mutation that gives tomatoes a uniform red color at the cost of the fruit's taste.[2] Varieties bearing this mutation, which have been favored by industry since the 1940s, feature fruits with lower levels of carotenoids and a decreased ability to make sugar within the fruit.[3]
                    </td>
                  <td>
                      £5.49
                    </td>
                  <td>
                    <input id="submitBtn2" type="submit" value="Add"/>
                  </td>
                </tr>

    
            </table>
          </div>
        

      </section>
      
      <section>
      <div>
        <table id="resultsTable">
        </table>
        </div>
      </section>
    </main>


      
    <script>
      const form=document.getElementById('raf')
      const submitBtn1=document.getElementById('submitBtn1')
      const submitBtn2=document.getElementById('submitBtn2')
      const resultsTable = document.getElementById('resultsTable')

      

      const mult = function(a, b){
      return ('£'+(Number(a)*Number(b)).toFixed(2));
    }

    const sum = function(a, b){
      return ('£'+(Number(a)+Number(b)).toFixed(2));
    }

    const calculateTotal = function(){
      const resultsTotal = document.getElementById('resultsTotal')
      resultsTotal.innerHTML =""
      if (resultsTable.rows["raf"]){
        resultsTotal.innerHTML =""
        const input1=document.getElementById('test1')
        const newLiTotal = document.createElement("p")
          newLiTotal.innerText = sum(input1.value*6.99,0);
          resultsTotal.append(newLiTotal)
      }
      if (resultsTable.rows["heirloom"]){
        resultsTotal.innerHTML =""
        const input2=document.getElementById('test2')
        const newLiTotal = document.createElement("p")
          newLiTotal.innerText = sum(0,input2.value*5.49 );
          resultsTotal.append(newLiTotal)
        }
        if (resultsTable.rows["raf"]&&resultsTable.rows["heirloom"]){
          resultsTotal.innerHTML =""
          const input1=document.getElementById('test1')
          const input2=document.getElementById('test2')
          const newLiTotal = document.createElement("p")
          newLiTotal.innerText = sum(input1.value*6.99,input2.value*5.49 );
          resultsTotal.append(newLiTotal)

        }
    }


      const submitHandler = function(event){
        // prevents form from reloading
        event.preventDefault()
        //clean ups results
        if (resultsTable.rows["raf"]){
        results1.innerHTML =""
        resultsTotal.innerHTML =""
        const input1=document.getElementById('test1')
        const newLi1 = document.createElement("p")
        newLi1.innerText = mult(input1.value,6.99 );
        results1.append(newLi1)
        const newLiTotal = document.createElement("p")
          newLiTotal.innerText = sum(input1.value*6.99,0);
          //submitBtn.append(newLi)
          resultsTotal.append(newLiTotal)

        }
        if (resultsTable.rows["heirloom"]){
        results2.innerHTML =""
        resultsTotal.innerHTML =""
        const input2=document.getElementById('test2')
        const newLi2 = document.createElement("p")
        newLi2.innerText = mult(input2.value,5.49 );
        results2.append(newLi2)
        const newLiTotal = document.createElement("p")
          newLiTotal.innerText = sum(0,input2.value*5.49 );
          //submitBtn.append(newLi)
          resultsTotal.append(newLiTotal)

        }
        if (resultsTable.rows["raf"]&&resultsTable.rows["heirloom"]){
          const input1=document.getElementById('test1')
        const input2=document.getElementById('test2')
          resultsTotal.innerHTML =""
          const newLiTotal = document.createElement("p")
          newLiTotal.innerText = sum(input1.value*6.99,input2.value*5.49 );
          resultsTotal.append(newLiTotal)

        }

        //console.log(event, event.target)
       //console.log(input.value)

 //populates results again


      }

      const submitHandler2 = function(event){
        // prevents form from reloading
        event.preventDefault()
        //clean ups results
        //resultsTable.innerHTML =""
       
        //console.log(event, event.target)
       //console.log(input.value)

 //populates results again


          if (!resultsTable.rows["raf"]){
            if (resultsTable.rows["resultsTotalRow"]){
            document.getElementById("resultsTable").removeChild(document.getElementById("resultsTotalRow"));  
            }
          const newCo1 = document.createElement("tr")
          newCo1.setAttribute("id", "raf");
          newCo1.innerHTML = "<td><img src=\"https://www.comenaranjas.com/images/stories/virtuemart/product/tomate-raf.jpg\" class=\"responsive_image\"></td><td>  <form id=\"raf\">      <input type=\"number\" name=\"quantity\" min=\"1\" id=\"test1\">     <!--input id=\"submitBtn\" type=\"submit\" /-->    </form></td><td><div id=\"results1\">£6.99</div></td><td><input id=\"deleteBtn1\" type=\"submit\" value=\"remove item\" /></td>"
          resultsTable.append(newCo1)
          const ColResult = document.createElement("tr")
          ColResult.setAttribute("id", "resultsTotalRow");
          ColResult.innerHTML = "<td class=\"tdTotal\" colspan=\"3\">TOTAL:</td><td class=\"tdTotal\"><div id=\"resultsTotal\"></div></td>"
          resultsTable.append(ColResult)
          const input1=document.getElementById('test1')
          input1.setAttribute("value", 1)
          input1.onclick = submitHandler 
          const results1 = document.getElementById('results1')
          const deleteBtn1=document.getElementById('deleteBtn1')
          deleteBtn1.onclick = deleteHandler1

          const newLi1 = document.createElement("p")
          newLi1.innerText = mult(input1.value,6.99 )
          results1.innerHTML =""
          results1.append(newLi1)
          calculateTotal()
          }
          console.log(resultsTable)
          

        }

        const submitHandler3 = function(event){
        // prevents form from reloading
        event.preventDefault()

 //populates results again


          if (!resultsTable.rows["heirloom"]){
            if (resultsTable.rows["resultsTotalRow"]){
            document.getElementById("resultsTable").removeChild(document.getElementById("resultsTotalRow"));  
            }
          const newCo1 = document.createElement("tr")
          newCo1.setAttribute("id", "heirloom");
          newCo1.innerHTML = "<td><img src=\"https://foodandstyle.com/wp-content/uploads/2009/07/IMG_9851-Hierloom-tomato-750.jpg\" class=\"responsive_image\"></td><td>  <form id=\"heirloom\">      <input type=\"number\" name=\"quantity\" min=\"1\" id=\"test2\">     </form></td><td><div id=\"results2\">£5.49</div></td><td><input id=\"deleteBtn2\" type=\"submit\" value=\"remove item\" /></td>"
          resultsTable.append(newCo1)
          const ColResult = document.createElement("tr")
          ColResult.setAttribute("id", "resultsTotalRow");
          ColResult.innerHTML = "<td class=\"tdTotal\" colspan=\"3\">TOTAL:</td><td class=\"tdTotal\"><div id=\"resultsTotal\"></div></td>"
          resultsTable.append(ColResult)

          const input2=document.getElementById('test2')
          input2.setAttribute("value", 1)
          input2.onclick = submitHandler 
          const results2 = document.getElementById('results2')
          const deleteBtn2=document.getElementById('deleteBtn2')
          deleteBtn2.onclick = deleteHandler2 

          const newLi1 = document.createElement("p")
          newLi1.innerText = mult(input2.value,5.49 )
          results2.innerHTML =""
          results2.append(newLi1)
          calculateTotal()
          }
          console.log(resultsTable)
          

        }


        const deleteHandler2 = function(event){
        // prevents form from reloading
        event.preventDefault()
          if (resultsTable.rows["heirloom"]){
            document.getElementById("resultsTable").removeChild(document.getElementById("heirloom"));  
          calculateTotal()
          }
          console.log(resultsTable)    

        }
        const deleteHandler1 = function(event){
        // prevents form from reloading
        event.preventDefault()
          if (resultsTable.rows["raf"]){
            document.getElementById("resultsTable").removeChild(document.getElementById("raf"));  
          calculateTotal()
          }
          console.log(resultsTable)    

        }



      submitBtn1.onclick = submitHandler2 
      submitBtn2.onclick = submitHandler3



//equivalent to
//submit.addEventListener("onclick", submitHandler)
    </script>
    <script>
    console.log(resultsTable)
    </script>
  </body>
</html>
